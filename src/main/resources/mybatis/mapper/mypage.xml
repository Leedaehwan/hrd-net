<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mypage">
	<select id="List" resultType="api.u_member.vo.UmemVO" parameterType="String">
		SELECT * FROM u_member
		WHERE id = #{id}
	</select>

	<update id="edit" parameterType="String">
		UPDATE u_member
		SET 
		<if test="addr != null">
			addr = #{addr},
		</if>
		<if test="addr2 != null">
			addr2 = #{addr2},
		</if>
		<if test="zonecode != null">
			zonecode = #{zonecode},
		</if>
		<if test="phone != null">
			phone = #{phone},
		</if>
		<if test="c_num != null">
			c_num = #{c_num},
		</if>
		<if test="name != null">
			c_num = #{name},
		</if>
		<if test="email != null">
			email = #{email}
		</if>
		WHERE id = #{id}
	</update>
	
	<update id="del" parameterType="String">
		UPDATE u_member
		SET stat = -1
		WHERE id = #{id}
	</update>
	

	<!-- 원글들을 가져오는 기능 (status가 1이면 삭제된 글, 
	정렬로 가장 최근의 글을 맨 위로 올라오도록 함!) -->
	<select id="myList" parameterType="Map" resultType="api.u_member.vo.TrVO">
		SELECT * FROM(
			SELECT rownum r_num, a.* FROM(SELECT * FROM TRANING
						WHERE stat = 1
						ORDER BY TRANING_id DESC
				) a
			) WHERE r_num BETWEEN #{begin} AND #{end} 
	</select>
	
	<!-- 총 게시물 수를 반환하는 SELECT -->
	<select id="totalCount" resultType="int">
		SELECT COUNT(*) FROM TRANING
		WHERE stat = 0
	</select>
	
	<!-- 원글 삭제 update -->
	<update id="delBbs" parameterType="String">
		UPDATE TRANING
		SET stat = -1
		WHERE TRANING_id = ${no}
	</update>

</mapper>

